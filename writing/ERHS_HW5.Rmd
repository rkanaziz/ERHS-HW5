---
title: "Homework #5, Choice #1"
author: "Rachel Kanaziz"
date: "11/11/2019"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, options(tigris_use_cache = TRUE))
library(tidyverse)
library(reshape2)
library(tigris)
library(sf)

```

# Homicide Data

```{r read data}
homicide_raw <- read_csv("../data/homicide-data.csv")
```

## Clean Data
Filter the data for the city of Denver

```{r denver}
denver <- homicide_raw %>% 
  filter(city == "Denver") %>% 
  select(lat, lon, disposition, victim_race)
```

## Map Boundaries

In this section, I used the zip codes for the Denver area to create boundaries for my base map. 

```{r zips}
denver_zips <- zctas(cb = TRUE, starts_with = c("802"), class = "sf")
plot(denver_zips)
```

## Number of Homicides by Victim Race

Here, I determined the three race groups (balck, white, hispanic) with the highest number of victim homicides. 

``` {r race}
race <- denver %>% 
  group_by(victim_race) %>% 
  mutate(count=n()) %>% 
  arrange(desc(count)) %>% 
  ungroup()

denver2 <- denver %>%
  filter(victim_race == c("Black", "White", "Hispanic"))
```


## Create the Map

### TO DO: Need to set CRS and figure out solves/unsolved facet

```{r map}
denver_crs <- denver2 %>% 
  filter(!is.na(lat)) %>% 
  st_as_sf(coords = c("lon", "lat")) %>% 
  st_set_crs(4269)

ggplot() + 
  geom_sf(data = denver_zips, color = "lightgray") + 
  geom_sf(data = denver_crs, aes(color = factor(victim_race)))
```
